<div fxLayout="column" fxFlexAlign="center center">
  <div fxLayout="row" fxFlex="100" class="reqdetails-title-bar ">
    <div fxFlex="95">Request Details</div>
    <button
      mat-stroked-button
      color="primary"
      (click)="closePopup()"
      style="color: white; font-size: small"
    >
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <div
    fxFlex="100"
    fxFlexOffset=".3"
    *ngIf="!showSpinner"
    style="border: 1px solid gray;  border-radius: 5px;"
  >
    <div fxLayout="column" fxFlex="25">
      <div class="pic-frame pic-frame--quick-zoom">
        <img class="resize-keep-aspect" src="{{ request.ImageUrl }}" />
      </div>
      <div
        class="status-flag  status-{{ request.Status | vettingStatusShorten }}"
      >
        {{ request.Status | vettingStatusPipe }}
      </div>
    </div>
    <div fxLayout="column" fxFlex="75">
      <div fxLayout="row">
        <div
          fxFlex="80"
          class="head-alert head-alert--{{
            requestDetails?.Alert.Level.toLowerCase()
          }}"
        >
          <i
            style="display: none; font-size: small !important"
            class="material-icons head-alert--{{
              requestDetails?.Alert.Level.toLowerCase()
            }}"
            >warning</i
          >
          {{ requestDetails?.Alert.Message }}
        </div>
        <div fxFlex="10"></div>
        <div fxFlex="10" class="modality-flag">{{ request.Modality }}</div>
      </div>
      <div fxLayout="row" fxFlexOffset="2">
        <div fxFlex="15" class="request-detail-label">Request:</div>
        <div fxFlex="65" class="digit-bar">
          {{ request.Id }}
        </div>

        <div fxFlex="20">
          <i
            class="material-icons"
            style="color:#616A6B; cursor: pointer;  "
            title="Copy to Clip-board"
            >content_copy</i
          >&nbsp;
        </div>
      </div>
      <div fxLayout="row" fxFlexOffset="1">
        <div fxFlex="15" class="request-detail-label">File:</div>
        <div fxFlex="85" class="request-detail-text">
          {{ requestDetails?.Filename }}
        </div>
      </div>
      <div fxLayout="row" fxFlexOffset="1">
        <div fxFlex="15" class="request-detail-label">Submitted:</div>
        <div fxFlex="85" class="request-detail-text">
          {{ request.StatusTimestamp | date: 'medium' }}
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!showSpinner" fxLayout="row" [fxFlex]="100" fxFlexOffset="1">
    <div [fxFlex]="pageSettings.FlexLeft" class="details-H2">
      VETTING SYSTEM RESPONSES
    </div>
    <div
      [fxFlex]="pageSettings.FlexRight"
      (click)="toggleLogs(pageSettings.DivExpandedRight)"
      fxFlexOffset="0.5"
      class="details-H2"
    >
      {{ pageSettings.TitleRight }}

      <button
        *ngIf="pageSettings.DivExpandedRight"
        mat-icon-button
        title="{{ pageSettings.ToolTipToggleButton + ' ' + 'Logs' }}"
        style="vertical-align: top; position: relative; top:-10px;"
      >
        <mat-icon>history</mat-icon>
      </button>

      <button
        *ngIf="!pageSettings.DivExpandedRight"
        mat-icon-button
        title="{{ pageSettings.ToolTipToggleButton + ' ' + 'Logs' }}"
        style="vertical-align: top; position: relative; top:-10px;"
      >
        <mat-icon>{{ pageSettings.ButtonIcon }}</mat-icon>
      </button>
    </div>
  </div>
  <div *ngIf="!showSpinner" fxLayout="row" fxFlex="100">
    <div fxFlex="column" class="response-details-log">
      <div fxLayout="row wrap">
        <div
          fxFlexOffset="1.5"
          *ngFor="let vettingSystem of requestDetails?.VettingSystems"
        >
          <!--Card Start-->
          <div fxFlexOffset="1.5" style="margin-top: 10px" fxLayout="column">
            <div fxLayout="row" class="response-card-head">
              <div fxFlex="50">
                <span title="collapse" class="toggle-icon">-</span>
                {{ vettingSystem.SystemName }}
              </div>
              <div
                fxFlex="50"
                class=" status-flag status-{{
                  vettingSystem.Status | vettingStatusShorten
                }}"
              >
                {{ vettingSystem.Status | vettingStatusPipe }}
              </div>
            </div>
            <div fxLayout="column" class="response-card">
              <div fxLayout="row" fxFlex="100">
                <div fxFlex="20">{{ vettingSystem.IdFieldName }}</div>
                <div fxFlex="80">
                  <span class="digit-bar"
                    >{{ vettingSystem.Ids.toString() }}
                  </span>
                </div>
              </div>
            </div>
          </div>
          <!--Card End-->
        </div>
      </div>
    </div>
    <div
      [fxFlex]="pageSettings.FlexRight"
      fxFlexOffset="0.5"
      class="response-details-log"
    >
      <div *ngIf="pageSettings.DivExpandedRight">
        <div
          *ngFor="let logItem of requestDetails?.RequestLogs"
          style="padding: 5px;"
        >
          <mat-card>
            <mat-card-content>
              <p
                style="font-family: 'Courier New', Courier, monospace; font-size:small;"
              >
                {{ logItem.Message }}
                <br />
                - {{ logItem.Timestamp | date: 'medium' }}
              </p>
            </mat-card-content>
          </mat-card>
        </div>
      </div>
      <div
        *ngIf="!pageSettings.DivExpandedRight"
        (click)="toggleLogs(pageSettings.DivExpandedRight)"
        class="collapsed-log-div"
      >
        <button
          mat-icon-button
          title="{{ pageSettings.ToolTipToggleButton + ' ' + 'Logs' }}"
        >
          <mat-icon>history</mat-icon>
        </button>
      </div>
    </div>
  </div>

  <div
    fxLayout="column"
    *ngIf="showSpinner"
    fxFlexOffset="20"
    fxLayoutAlign="center center"
  >
    <mat-spinner
      matTooltip="Loading data"
      style="text-align: center"
      diameter="40"
    ></mat-spinner>
  </div>
</div>
